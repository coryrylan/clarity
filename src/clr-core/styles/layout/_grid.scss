// Copyright (c) 2016-2020 VMware, Inc. All Rights Reserved.
// This software is released under MIT license.
// The full license information can be found in LICENSE in the root directory of this project.

cds-layout {
  width: 100%;
  --gap: 0px;
  --x-align: flex-start;
  --y-align: flex-start;

  &[align-items~='top'] {
    --y-align: flex-start;
  }

  &[align-items~='bottom'] {
    --y-align: flex-end;
  }

  &[align-items~='vertical-center'] {
    --y-align: center;
  }

  &[align-items~='left'] {
    --x-align: flex-start;
  }

  &[align-items~='horizontal-stretch'] {
    --x-align: stretch;
  }

  &[align-items~='vertical-stretch'] {
    --y-align: stretch;
  }

  &[align-items~='right'] {
    --x-align: flex-end;
  }

  &[align-items~='horizontal-center'] {
    --x-align: center;
  }

  &[align-items~='center'] {
    --x-align: center;
    --y-align: center;
  }

  &[align-items~='stretch'] {
    --x-align: stretch;
    --y-align: stretch;
  }

  &[gap='xs'] {
    --gap: #{$cds-token-layout-space-xs};
  }

  &[gap='sm'] {
    --gap: #{$cds-token-layout-space-sm};
  }

  &[gap='md'] {
    --gap: #{$cds-token-layout-space-md};
  }

  &[gap='lg'] {
    --gap: #{$cds-token-layout-space-lg};
  }

  &[gap='xl'] {
    --gap: #{$cds-token-layout-space-xl};
  }
}

cds-layout[type='horizontal'] {
  display: inline-flex;
  flex-direction: row;
  flex-wrap: wrap;
  align-content: var(--y-align);
  justify-content: var(--x-align);
  margin-left: calc(-1 * var(--gap));
  margin-top: calc(-1 * var(--gap));
  width: calc(100% + var(--gap));

  & > * {
    margin-left: var(--gap);
    margin-top: var(--gap);
  }

  &[align-items~='stretch'] > *,
  &[align-items~='horizontal-stretch'] > * {
    flex-grow: 1;
  }

  &[align-items~='stretch'] > *,
  &[align-items~='vertical-stretch'] {
    align-content: stretch;
  }

  &[gap='xs'] {
    --gap: #{$cds-token-layout-space-xs};
  }

  &[gap='sm'] {
    --gap: #{$cds-token-layout-space-sm};
  }

  &[gap='md'] {
    --gap: #{$cds-token-layout-space-md};
  }

  &[gap='lg'] {
    --gap: #{$cds-token-layout-space-lg};
  }

  &[gap='xl'] {
    --gap: #{$cds-token-layout-space-xl};
  }
}

cds-layout[type='vertical'] {
  display: inline-flex;
  flex-direction: column;
  justify-content: var(--y-align);
  justify-items: var(--y-align);
  align-items: var(--x-align);

  &[align-items~='stretch'],
  &[align-items~='horizontal-stretch'] {
    align-items: stretch;
  }

  &[align-items~='stretch'] > *,
  &[align-items~='vertical-stretch'] > * {
    flex-grow: 1;
  }

  &[gap='xs'] > * {
    margin-bottom: $cds-token-layout-space-xs;
  }

  &[gap='sm'] > * {
    margin-bottom: $cds-token-layout-space-sm;
  }

  &[gap='md'] > * {
    margin-bottom: $cds-token-layout-space-md;
  }

  &[gap='lg'] > * {
    margin-bottom: $cds-token-layout-space-lg;
  }

  &[gap='xl'] > * {
    margin-bottom: $cds-token-layout-space-xl;
  }

  & > *:last-child {
    margin-bottom: 0;
  }
}

cds-layout[type='grid'] {
  display: grid;
  grid-gap: var(--gap);
  align-items: start;
  align-content: start;
  justify-items: var(--x-align);
  grid-template-columns: repeat($cds-token-layout-grid-cols, 1fr);

  &[cols='auto'] {
    grid-auto-flow: column;
    grid-template-columns: initial;
  }

  &[align-items~='vertical-stretch'] {
    align-items: stretch;
    align-content: stretch;
  }

  &[align-items~='vertical-center'] {
    align-items: center;
    align-content: center;
  }

  &[align-items~='stretch'] {
    align-items: stretch;
    align-content: stretch;
  }

  &[align-items~='center'] {
    align-items: center;
    align-content: center;
  }

  &[align-items~='bottom'] {
    align-items: end;
    align-content: end;
  }

  // gap axis
  &[gap^='[xs'] {
    row-gap: $cds-token-layout-space-xs;
  }

  &[gap$='xs]'] {
    column-gap: $cds-token-layout-space-xs;
  }

  &[gap^='[sm'] {
    row-gap: $cds-token-layout-space-sm;
  }

  &[gap$='sm]'] {
    column-gap: $cds-token-layout-space-sm;
  }

  &[gap^='[md'] {
    row-gap: $cds-token-layout-space-md;
  }

  &[gap$='md]'] {
    column-gap: $cds-token-layout-space-md;
  }

  &[gap^='[lg'] {
    row-gap: $cds-token-layout-space-lg;
  }

  &[gap$='lg]'] {
    column-gap: $cds-token-layout-space-lg;
  }

  &[gap^='[xl'] {
    row-gap: $cds-token-layout-space-xl;
  }

  &[gap$='xl]'] {
    column-gap: $cds-token-layout-space-xl;
  }
}

cds-layout[cols*='\@'] {
  grid-template-columns: 12fr;
  grid-column: span $cds-token-layout-grid-cols;
}

[cds-row*='span-'],
[cds-row*='end-'] {
  align-self: stretch;
}

%full-width-columns-explicit {
  grid-column: span $cds-token-layout-grid-cols;
}

@for $i from 1 through $cds-token-layout-grid-cols-static {
  [cds-col~='span-#{$i}\@sm'],
  [cds-col~='span-#{$i}\@md'],
  [cds-col~='span-#{$i}\@lg'],
  [cds-col~='span-#{$i}\@xl'] {
    @extend %full-width-columns-explicit;
  }
}

@for $i from 1 through $cds-token-layout-grid-cols-static {
  cds-layout[cols~='#{$i}'] {
    grid-template-columns: repeat($i, 1fr);
  }

  cds-layout[rows~='#{$i}'] {
    grid-template-rows: repeat($i, 1fr);
  }
}

@for $i from 1 through $cds-token-layout-grid-cols-static {
  [cds-col~='span-#{$i}'] {
    grid-column: span $i / span $i;
  }

  [cds-row~='span-#{$i}'] {
    grid-row: span $i / span $i;
  }
}

@media (min-width: $cds-token-layout-width-sm-static) {
  @include generateColumnsAndRows('sm');
}

@media (min-width: $cds-token-layout-width-md-static) {
  @include generateColumnsAndRows('md');
}

@media (min-width: $cds-token-layout-width-lg-static) {
  @include generateColumnsAndRows('lg');
}

@media (min-width: $cds-token-layout-width-xl-static) {
  @include generateColumnsAndRows('xl');
}

// start/end positions
@for $i from 1 through $cds-token-layout-grid-cols-static {
  [cds-col~='start-#{$i}'] {
    grid-column-start: $i;
  }

  [cds-row~='start-#{$i}'] {
    grid-row-start: $i;
  }

  [cds-col~='end-#{$i}'] {
    grid-column-end: $i;
  }

  [cds-row~='end-#{$i}'] {
    grid-row-end: $i;
  }
}

@media (min-width: $cds-token-layout-width-sm-static) {
  @include position('sm');
}

@media (min-width: $cds-token-layout-width-md-static) {
  @include position('md');
}

@media (min-width: $cds-token-layout-width-lg-static) {
  @include position('lg');
}

@media (min-width: $cds-token-layout-width-xl-static) {
  @include position('xl');
}

cds-layout > [cds-align~='stretch'] {
  flex-grow: 1 !important;
}

cds-layout > [cds-align~='shrink'] {
  flex-shrink: 1 !important;
  flex-grow: 0 !important;
}
