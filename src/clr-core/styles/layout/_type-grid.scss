// Copyright (c) 2016-2020 VMware, Inc. All Rights Reserved.
// This software is released under MIT license.
// The full license information can be found in LICENSE in the root directory of this project.

@mixin generateColumnsAndRows($breakpoint) {
  @for $i from 1 through $cds-token-layout-grid-cols-static {
    // implicit columns/rows
    [cds-layout~='cols-#{$i}\@#{$breakpoint}'] > * {
      grid-column: span $i / span $i;
    }

    [cds-layout~='rows-#{$i}\@#{$breakpoint}'] > * {
      grid-row: span $i / span $i;
    }
  }

  @for $i from 1 through $cds-token-layout-grid-cols-static {
    // explicit column/row positions
    [cds-layout~='col-#{$i}\@#{$breakpoint}'] {
      grid-column: span $i / span $i !important;
    }

    [cds-layout~='row-#{$i}\@#{$breakpoint}'] {
      grid-row: span $i / span $i !important;
    }
  }
}

@mixin position($breakpoint) {
  // +1 for grid cols/rows which end at beginning of next item
  @for $i from 1 through $cds-token-layout-grid-cols-static + 1 {
    [cds-layout~='col-start-#{$i}\@#{$breakpoint}'] {
      grid-column-start: $i !important;
    }

    [cds-layout~='col-end-#{$i}\@#{$breakpoint}'] {
      grid-column-end: $i !important;
    }

    [cds-layout~='row-start-#{$i}\@#{$breakpoint}'] {
      grid-row-start: $i !important;
    }

    [cds-layout~='row-end-#{$i}\@#{$breakpoint}'] {
      grid-row-end: $i !important;
    }
  }
}

[cds-layout~='grid'] {
  display: grid;
  align-items: flex-start;
  align-content: flex-start;
  grid-template-columns: repeat($cds-token-layout-grid-cols, 1fr);
  width: 100%;

  // alignments
  &[cds-layout~='align-items-top'] {
    align-items: start;
    align-content: start;
  }

  &[cds-layout~='align-items-right'] {
    justify-items: flex-end;
  }

  &[cds-layout~='align-items-bottom'] {
    align-items: end;
    align-content: end;
  }

  &[cds-layout~='align-items-left'] {
    justify-items: flex-start;
    align-content: flex-start;
  }

  &[cds-layout~='align-items-vertical-stretch'] {
    align-items: stretch;
    align-content: stretch;
  }

  &[cds-layout~='align-items-vertical-center'] {
    align-items: center;
    align-content: center;
  }

  &[cds-layout~='align-items-horizontal-stretch'] {
    justify-items: stretch;
    justify-content: stretch;
  }

  &[cds-layout~='align-items-horizontal-center'] {
    justify-items: center;
    justify-content: center;
  }

  &[cds-layout~='align-items-stretch'] {
    align-items: stretch;
    align-content: stretch;
    justify-items: stretch;
    justify-content: stretch;
  }

  &[cds-layout~='align-items-center'] {
    align-items: center;
    align-content: center;
  }

  &[cds-layout~='gap-xs'] {
    grid-gap: #{$cds-token-layout-space-xs};
  }

  &[cds-layout~='gap-sm'] {
    grid-gap: #{$cds-token-layout-space-sm};
  }

  &[cds-layout~='gap-md'] {
    grid-gap: #{$cds-token-layout-space-md};
  }

  &[cds-layout~='gap-lg'] {
    grid-gap: #{$cds-token-layout-space-lg};
  }

  &[cds-layout~='gap-xl'] {
    grid-gap: #{$cds-token-layout-space-xl};
  }
}

[cds-layout~='grid'] {
  &[cds-layout~='cols-auto'] {
    grid-auto-flow: column;
    grid-template-columns: initial;
  }

  &[cds-layout*='\@'] {
    grid-column: span $cds-token-layout-grid-cols-static / span $cds-token-layout-grid-cols-static;
  }

  &[cds-layout~='rows'] {
    grid-template-rows: repeat(12, auto);
  }

  & > [cds-layout~='row'] {
    align-self: stretch;
  }
}

%full-width-columns-explicit {
  grid-column: span $cds-token-layout-grid-cols;
}

@for $i from 1 through $cds-token-layout-grid-cols-static {
  [cds-layout~='col-#{$i}\@sm'],
  [cds-layout~='col-#{$i}\@md'],
  [cds-layout~='col-#{$i}\@lg'],
  [cds-layout~='col-#{$i}\@xl'] {
    @extend %full-width-columns-explicit;
  }
}

@for $i from 1 through $cds-token-layout-grid-cols-static {
  [cds-layout~='cols-#{$i}'] > * {
    grid-column: span $i / span $i;
  }

  [cds-layout~='rows-#{$i}'] > * {
    grid-row: span $i / span $i;
  }
}

@for $i from 1 through $cds-token-layout-grid-cols-static {
  [cds-layout~='col-#{$i}'] {
    grid-column: span $i / span $i !important;
  }

  [cds-layout~='row-#{$i}'] {
    grid-row: span $i / span $i !important;
  }
}

@media (min-width: $cds-token-layout-width-sm-static) {
  @include generateColumnsAndRows('sm');
}

@media (min-width: $cds-token-layout-width-md-static) {
  @include generateColumnsAndRows('md');
}

@media (min-width: $cds-token-layout-width-lg-static) {
  @include generateColumnsAndRows('lg');
}

@media (min-width: $cds-token-layout-width-xl-static) {
  @include generateColumnsAndRows('xl');
}

// start/end positions
@for $i from 1 through $cds-token-layout-grid-cols-static + 1 {
  // +1 for grid cols/rows which end at beginning of next item
  [cds-layout~='col-start-#{$i}'] {
    grid-column-start: $i !important;
  }

  [cds-layout~='row-start-#{$i}'] {
    grid-row-start: $i !important;
  }

  [cds-layout~='col-end-#{$i}'] {
    grid-column-end: $i !important;
  }

  [cds-layout~='row-end-#{$i}'] {
    grid-row-end: $i !important;
  }
}

@media (min-width: $cds-token-layout-width-sm-static) {
  @include position('sm');
}

@media (min-width: $cds-token-layout-width-md-static) {
  @include position('md');
}

@media (min-width: $cds-token-layout-width-lg-static) {
  @include position('lg');
}

@media (min-width: $cds-token-layout-width-xl-static) {
  @include position('xl');
}
